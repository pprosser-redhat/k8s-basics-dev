<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled :: Kubernetes Basic Workshop</title>
    <link rel="canonical" href="https://github.com/pprosser-redhat/k8s-basics-dev.git/modules/06-labelling-of-resources.html">
    <meta name="generator" content="Antora 3.1.12">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://unpkg.com/clipboard@2/dist/clipboard.min.js"></script>
  </head>
  <body class="article">
<header class="header" role="banner">

</header>
<div class="main-wrapper">

  <main class="main">
<div class="toolbar" role="navigation">
</div><article class="doc">
<div class="paragraph">
<p>The ability to use <code>kubectl</code> to query resource definitions and their current status is important because it is the resource definitions which drive Kubernetes and what it does.</p>
</div>
<div class="paragraph">
<p>As we already saw, it isn&#8217;t a single resource definition which defines everything about the deployment of an application, but a set of resources.</p>
</div>
<div class="paragraph">
<p>In order to indicate that a set of resources are related, they can be labelled. You can then perform queries to look up resources based on the labels.</p>
</div>
<div class="paragraph">
<p>In order to narrow the results down so it shows just the resources for the front end web application, we can add to the <code>kubectl get</code> command a label selector using the <code>-l</code> or <code>--selector</code> option.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-execute hljs" data-lang="execute">kubectl get deployment,service,ingress,secret,pvc -o name -l app=workshop</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case we have also provided a comma separated list of the resources we wish to query about in addition to searching based on the applied labels.</p>
</div>
<div class="paragraph">
<p>This should yield:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">deployment.apps/mongodb-community-server
deployment.apps/nationalparks-py
deployment.apps/parksmap
service/mongodb-community-server
service/nationalparks-py
service/parksmap
ingress.networking.k8s.io/nationalparks-py
ingress.networking.k8s.io/parksmap</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the sample application you are deploying, all resources for the application were given a label of <code>app=workshop</code>.</p>
</div>
<div class="paragraph">
<p>One important use case for labels is when you want to delete an application. Where an application is defined by a set of resources, it is cumbersome and error prone to have to delete each resource one at a time. Using a label selector, you can delete them all at once.</p>
</div>
<div class="paragraph">
<p>The procedure for deleting an application would be to first use <code>kubectl get</code> with a label selector to determine that you have the correct set of resources, and then substitute <code>kubectl get</code> with the <code>kubectl delete</code> command.</p>
</div>
<div class="paragraph">
<p>Delete the front end web application now by running:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-execute hljs" data-lang="execute">kubectl delete deployment,service,ingress,robebinding -l role=frontend</code></pre>
</div>
</div>
<div class="paragraph">
<p>This should output:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">deployment.apps "blog" deleted
service "blog" deleted
ingress.extensions "blog" deleted
persistentvolumeclaim "blog-media" deleted</code></pre>
</div>
</div>
<div class="paragraph">
<p>Having deleted the front end web application, we will now re-deploy it, but this time we will do it one step at a time so you can understand what each of the resources is for and what Kubernetes does in response to the resource definitions being created.</p>
</div>
</article>
  </main>
</div>
<footer role="contentinfo">
  <div class="region region-rhd-footer">
    <div id="block-rhdfooter" class="rhd-footer">
      <nav class="rhd-footer-nav" aria-label="Secondary Navigation" role="navigation">
  <ul class="rhd-menu">
    
  </ul>
</nav>
    </div>
  </div>
</footer>
<script src="../_/js/site.js"></script>
<script src="../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
  integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
  integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
  integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  </body>
</html>
